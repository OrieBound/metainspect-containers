<mxfile host="app.diagrams.net" modified="2026-02-17T00:00:00.000Z" agent="codex" version="24.7.17" type="device">
  <diagram id="metainspect-arch" name="MetaInspect AWS Architecture">
    <mxGraphModel dx="1820" dy="1040" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="2200" pageHeight="1400" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <mxCell id="title" value="MetaInspect CloudFormation Architecture (dev)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;fontSize=20;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="20" width="700" height="40" as="geometry" />
        </mxCell>

        <mxCell id="internet" value="Internet Users" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="60" y="150" width="150" height="60" as="geometry" />
        </mxCell>

        <mxCell id="ecr" value="ECR Repository&#xa;${ProjectName}-${EnvironmentName}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="1820" y="180" width="260" height="90" as="geometry" />
        </mxCell>

        <mxCell id="autoscaling" value="Application Auto Scaling&#xa;CPU target tracking" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1820" y="320" width="260" height="90" as="geometry" />
        </mxCell>

        <mxCell id="logs" value="CloudWatch Logs&#xa;/ecs/${ProjectName}-${EnvironmentName}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="1820" y="460" width="260" height="90" as="geometry" />
        </mxCell>

        <mxCell id="vpc" value="VPC&#xa;10.42.0.0/16" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=2;verticalAlign=top;spacingTop=6;" vertex="1" parent="1">
          <mxGeometry x="260" y="90" width="1480" height="980" as="geometry" />
        </mxCell>

        <mxCell id="igw" value="Internet Gateway" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="vpc">
          <mxGeometry x="560" y="40" width="180" height="60" as="geometry" />
        </mxCell>

        <mxCell id="publicA" value="Public Subnet A&#xa;10.42.0.0/24" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;verticalAlign=top;spacingTop=6;" vertex="1" parent="vpc">
          <mxGeometry x="60" y="140" width="640" height="250" as="geometry" />
        </mxCell>

        <mxCell id="publicB" value="Public Subnet B&#xa;10.42.1.0/24" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;verticalAlign=top;spacingTop=6;" vertex="1" parent="vpc">
          <mxGeometry x="780" y="140" width="640" height="250" as="geometry" />
        </mxCell>

        <mxCell id="alb" value="Application Load Balancer&#xa;Listener :80" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#4d90fe;" vertex="1" parent="vpc">
          <mxGeometry x="560" y="190" width="320" height="90" as="geometry" />
        </mxCell>

        <mxCell id="tg" value="Target Group&#xa;HTTP /health" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="vpc">
          <mxGeometry x="930" y="205" width="220" height="60" as="geometry" />
        </mxCell>

        <mxCell id="natA" value="NAT Gateway A" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="publicA">
          <mxGeometry x="90" y="120" width="170" height="60" as="geometry" />
        </mxCell>

        <mxCell id="natB" value="NAT Gateway B" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="publicB">
          <mxGeometry x="90" y="120" width="170" height="60" as="geometry" />
        </mxCell>

        <mxCell id="serviceA" value="Service Subnet A&#xa;10.42.10.0/24" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f4d7;strokeColor=#b3a500;verticalAlign=top;spacingTop=6;" vertex="1" parent="vpc">
          <mxGeometry x="60" y="460" width="640" height="420" as="geometry" />
        </mxCell>

        <mxCell id="serviceB" value="Service Subnet B&#xa;10.42.11.0/24" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f4d7;strokeColor=#b3a500;verticalAlign=top;spacingTop=6;" vertex="1" parent="vpc">
          <mxGeometry x="780" y="460" width="640" height="420" as="geometry" />
        </mxCell>

        <mxCell id="cluster" value="ECS Cluster&#xa;metainspect-cluster-dev" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6f7ff;strokeColor=#0099cc;" vertex="1" parent="vpc">
          <mxGeometry x="560" y="540" width="320" height="80" as="geometry" />
        </mxCell>

        <mxCell id="service" value="ECS Service&#xa;metainspect-svc-dev&#xa;Fargate DesiredCount=2" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5fe;strokeColor=#0277bd;" vertex="1" parent="vpc">
          <mxGeometry x="560" y="650" width="320" height="100" as="geometry" />
        </mxCell>

        <mxCell id="taskdef" value="Task Definition&#xa;CPU 512, Memory 1024&#xa;Image: ECR:ContainerImageTag" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d9edf7;strokeColor=#31708f;" vertex="1" parent="vpc">
          <mxGeometry x="930" y="650" width="260" height="100" as="geometry" />
        </mxCell>

        <mxCell id="efs" value="EFS File System + Access Point&#xa;Mount targets in both service subnets" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f4e1ff;strokeColor=#8e44ad;" vertex="1" parent="vpc">
          <mxGeometry x="1030" y="540" width="330" height="90" as="geometry" />
        </mxCell>

        <mxCell id="sgs" value="Security Groups&#xa;ALB SG -> Service SG -> EFS SG" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#eeeeee;strokeColor=#666666;" vertex="1" parent="vpc">
          <mxGeometry x="1030" y="780" width="330" height="70" as="geometry" />
        </mxCell>

        <mxCell id="edge1" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="internet" target="alb">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge2" value="forward" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="vpc" source="alb" target="tg">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge3" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="vpc" source="tg" target="service">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge4" value="runs" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="vpc" source="cluster" target="service">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge5" value="uses" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="vpc" source="service" target="taskdef">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge6" value="pull image" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="taskdef" target="ecr">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge7" value="mount /efs/shared" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="vpc" source="service" target="efs">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge8" value="logs" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="service" target="logs">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge9" value="scale desired count" style="endArrow=block;html=1;strokeWidth=2;" edge="1" parent="1" source="autoscaling" target="service">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge10" value="egress" style="endArrow=block;html=1;dashed=1;strokeWidth=2;" edge="1" parent="vpc" source="serviceA" target="natA">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge11" value="egress" style="endArrow=block;html=1;dashed=1;strokeWidth=2;" edge="1" parent="vpc" source="serviceB" target="natB">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge12" style="endArrow=block;html=1;dashed=1;strokeWidth=2;" edge="1" parent="vpc" source="natA" target="igw">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edge13" style="endArrow=block;html=1;dashed=1;strokeWidth=2;" edge="1" parent="vpc" source="natB" target="igw">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
